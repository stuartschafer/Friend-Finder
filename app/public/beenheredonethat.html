<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Friend Finder</title>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/css/materialize.min.css">
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/js/materialize.min.js"></script>
    <!-- This links to the jQuery Library -->
    <script src="https://code.jquery.com/jquery-3.1.1.js"></script>
    <!--Google glph icon-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="/data/friends.js"></script>
</head>
<body>

<nav>
    <div class="nav-wrapper blue lighten-1">
        <a href="/" class="brand-logo center">Friend Finder</a>
        <ul class="left hide-on-med-and-down">
            <li><a href="/">Survey</a></li>
            <li class="active"><a href="/searchagain">Search Again</a></li>
        </ul>
    </div>
</nav>

<div class="container">
    <div class="col s12 center-align">
        <h1><strong>Welcome to Friend Finder</strong></h1>
        <h3>A place to meet other friends, like you!</h3>
        <h5>Please enter your first name, and unique ID#</h5>
        <h5>If you do not have that, please visit the survey page first</h5>
    </div>
</div>





<div class="container">
    <div class="row">
        <div class="input-field col s6 offset-s3">
            <i class="material-icons prefix">account_circle</i>
            <input id="icon_prefix_name" type="text" class="validate" placeholder="Please enter your first name">
        </div>
    </div>
    <div class="row">
        <div class="input-field col s6 offset-s3">
            <i class="material-icons prefix">fingerprint</i>
            <input id="icon_prefix_photo" type="number" class="validate" placeholder="Please enter your unique ID#">
        </div>
    </div>
</div>

<div class="returningMember">
    <h3><span id="welcome_back"></span></h3>
    <h4>There have been <span id="newPeeps"></span> new people here since you last signed up</h4>
    <h4>Please enter the search button to see if there are any closer matches.</h4>
</div>

<h4>
    <div id="searchResult"></div>
</h4> 

<div class="row center-align">
    <button class="btn waves-effect waves-light" id="submit" type="submit" name="action">Submit
        <i class="material-icons right">send</i><i class="material-icons left">send</i>
    </button>

    <button class="btn waves-effect waves-light" id="newSearch" type="submit" name="action">Search for Matches
        <i class="material-icons right">send</i><i class="material-icons left">send</i>
    </button>
</div>


<script type="text/javascript">
var allFriends = {};
var newFriend = {};
var userName = "";
var position = 0;
var newPeopleSinceLast = 0;
$(".returningMember").hide();
$("#newSearch").hide();

// $("#submit").on("click", function() {
//     $.get("/api", function(data) {
//         position = $("#icon_prefix_photo").val();
//         userName = $("#icon_prefix_name").val();
//         newPeopleSinceLast = data.length - position;
//         newFriend = data[(position - 1)];

//         // This checks to make sure it is an actual position in the array
//         if (position > data.length) {
//             alert("Sorry, that does not register with an exisiting user.");
//             return;
//         }

//         // This checks to make sure the name matches the existing user
//         if ((newFriend.name).toLowerCase() === userName.toLowerCase()) {
//             $("#welcome_back").text("Welcome back " + newFriend.name + "!");
//             $(".returningMember").fadeIn("slow");
//             $("#newPeeps").text(newPeopleSinceLast);
//             $(".row").fadeOut();
//             $("#submit").hide();
//             $("#newSearch").show();
//         } else {
//             alert("Sorry, that does not register with an exisiting user.");
//             return;
//         }
//     });
// });

// $("#newSearch").on("click", function() {
//     $.get("/api", function(data) {
//         var scoreArray = [];
//         console.log(data);

//         // This will go through every friend except the user's position
//         for (var i = 0; i < (data.length); i++) {
//             if (i != (position - 1)) {
//                 console.log(i);
//                 var diff = 0;
//                 // This calculates the difference of each question's score and adds the difference
//                 for (var j = 0; j < 10; j++) {
                    
//                     diff += Math.abs(data[i].scores[j] - newFriend.scores[j]);
//                 }
//                 // This pushes the total difference score into an array
//                 // The lowest score in the array is the person (allFriends[]) they are best matched with
//                 scoreArray.push(diff);
//             }
//         }

//         indexofSmallestNumber();

//             function indexofSmallestNumber() {
//                 var min = scoreArray[0];
//                 var minIndex = 0;
//                 for (var i = 0; i < scoreArray.length; i++) {
//                     if (scoreArray[i] < min) {
//                         minIndex = i;
//                         min = scoreArray[i];
//                     }
//                 }
//                 $("#newSearch").hide();
//                 $("#searchResult").text("You are matched closest with " + data[minIndex].name);  
//             }
//     });
// });

</script>
</body>
</html>